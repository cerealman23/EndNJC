<!DOCTYPE html>
<meta charset="utf-8">
<style>
  
/* CSS goes here. */

</style>
<body>
<script src="//d3js.org/d3.v7.min.js" charset="utf-8"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>
<script>

/* JavaScript goes here. */

var width = 1300,
    height = 1000;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var svg2 = d3.select("body").append("svg")
      .attr("width", width)
      .attr("height", height)



var projection = d3.geoAlbersUsa()
.scale(1000)

  d3.csv("county-prison.csv").then(function(county) {

  //     console.log(county)
var color = d3.scaleQuantize()
.range(["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"])
.domain([d3.min(county, d => d.jail ), d3.max(county, d => d.jail)])

      
      d3.json("counties.json").then( function(uk) {
	  
      for (var i = 0; i < county.length; i++) {

	  var county_name = county[i].county

	  var val = county[i].jail


	  for (var j = 0; j < uk.objects.counties.geometries.length; j++) {
	      map_name = uk.objects.counties.geometries[j].properties.name


	      if (county_name == map_name) {
		  console.log("match")
		  uk.objects.counties.geometries[j].properties["value"] = val
			      break;
	      }
	      
	  }
	  
      }
	  console.log(uk);
	  svg.selectAll("path")
	      .data(topojson.feature(uk, uk.objects.counties).features)
	      .enter().append("path")
	      .attr("stroke", "black")
	  // .data(topojson.feature(us, us.objects.counties).features)
			      .attr("d", d3.geoPath().projection(projection))
			      .attr("fill", function(d) {
			      value = d.properties.value
			      console.log(value)
			      if (value) {
			        return color(value)
			      } else {
			        return "#ccc"
			      }
			      })
	      .on("mouseover", function (d) {
		  d3.select(this).attr("fill", "red")
	      })

	  
      });
      
  })
  

  // d3.csv("incarceration_trends_jail_jurisdiction.csv")
  //   .then(function (d) {
  // 	console.log(d)
  //   })
  
</script>
